#!/bin/sh
set -e

# ‚õî Push gate ‚Äî mirrors the pip ‚Üí uv pattern.
#
# Direct `git push` is BLOCKED.
# Per AGENTS.md, the user must explicitly approve every push.
#
# To push with approval, use:
#   COLLAB_PUSH_APPROVED=1 git push
#
if [ -z "$COLLAB_PUSH_APPROVED" ]; then
  echo ""
  echo "‚õî  Direct git push is not allowed."
  echo ""
  echo "    Per AGENTS.md rules, you must ask the user for permission"
  echo "    before pushing to origin."
  echo ""
  echo "    Once the user approves, push with:"
  echo "      COLLAB_PUSH_APPROVED=1 git push"
  echo ""
  exit 1
fi

echo "üîç Running pre-push checks (tests + build)..."
npm run preflight
echo "‚úÖ Pre-push checks passed."
